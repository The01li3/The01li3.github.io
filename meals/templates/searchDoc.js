var varrRecipes = [
	{
		"id":"americanPancakes.html",
		"title":"American Pancakes",
		"description":"American, pancake, dessert, vegetarian, pan",
		"ingredients":["milk", "plain flour", "baking powder", "sugar", "egg", "oil", "butter", "salt", "pecans", "maple syrup"],
		"utensils":"cast iron"
	},
	{
		"id":"bananaCake.html",
		"title":"Banana Cake",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":"Loose Bottom Cake Tin"
	},
	{
		"id":"buffaloCauliflowerCasserole.html",
		"title":"Buffalo Cauliflower Casserole",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":"Casserole Dish"
	},
	{
		"id":"buffaloRanchPasta.html",
		"title":"Buffalo Ranch Pasta",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"buffaloSauce.html",
		"title":"Buffalo Sauce",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"carrotCake.html",
		"title":"Carrot Cake",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":"Loose Bottom Cake Tin"
	},
	{
		"id":"castIronNaan.html",
		"title":"Cast Iron Naan",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":"Cast Iron"
	},
	{
		"id":"chanaMasala.html",
		"title":"Chana Masala",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":"Slow Cooker"
	},
	{
		"id":"cheeseAndMarmiteSwirls.html",
		"title":"Cheese And Marmite Swirls",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"chickenAlfredo.html",
		"title":"Chicken Alfredo",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"coconutRice.html",
		"title":"Coconut Rice",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"creamCheeseFrosting.html",
		"title":"Cream Cheese Frosting",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"crepePancakes.html",
		"title":"Pancakes",
		"description":"pancake, dessert, vegetarian, pan",
		"ingredients":["milk", "plain flour", "sugar", "egg", "oil", "lemon", "butter"],
		"utensils":""
	},
	{
		"id":"garlicAndGingerCurry.html",
		"title":"Garlic And Ginger Curry",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"greekStyleBeans.html",
		"title":"Greek Style Beans",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":"Casserole Dish"
	},
	{
		"id":"hoisinCashewTofu.html",
		"title":"Hoisin Cashew Tofu",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"kasespatzle.html",
		"title":"Kasespatzle",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"lemonPosset.html",
		"title":"Lemon Posset",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":"Ramekin"
	},
	{
		"id":"lemonStirFry.html",
		"title":"Lemon Stir Fry",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"meadBasics.html",
		"title":"Mead Basics",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":"â€¦TBD"
	},
	{
		"id":"misoSoup.html",
		"title":"Miso Soup",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"nachoCasserole.html",
		"title":"Nacho Casserole",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":"Casserole Dish"
	},
	{
		"id":"noKneadFocaccia.html",
		"title":"No Knead Focaccia",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":"Cast Iron"
	},
	{
		"id":"pecanTassies.html",
		"title":"Pecan Tassies",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":"Mini Muffin Tray, Stamper, Rolling Pin"
	},
	{
		"id":"pineappleColeslaw.html",
		"title":"Pineapple Coleslaw",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"ramenBase.html",
		"title":"Ramen Base",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"risottoBasics.html",
		"title":"Risotto Basics",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"sataySauce.html",
		"title":"Satay Sauce",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"slowCookedButterChicken.html",
		"title":"Slow Cooked Butter Chicken",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":"Slow Cooker"
	},
	{
		"id":"slowCookedVegetarianRedThaiCurry.html",
		"title":"Slow Cooked Vegetarian Red Thai Curry",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":"Slow Cooker"
	},
	{
		"id":"spicedAppleCake.html",
		"title":"Spiced Apple Cake",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":"Square Cake Tin"
	},
	{
		"id":"spinacheRicottaCannelloni.html",
		"title":"Spinache Ricotta Cannelloni",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":"Piping Bag"
	},
	{
		"id":"springRolls.html",
		"title":"Spring Rolls",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"stickyLemonTofu.html",
		"title":"Sticky Lemon Tofu",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"stickyMangoRice.html",
		"title":"Sticky Mango Rice",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"sushiBasics.html",
		"title":"Sushi Basics",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":"Rolling Mat"
	},
	{
		"id":"tamarindFishCurry.html",
		"title":"Tamarind Fish Curry",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"tempehTacos.html",
		"title":"Tempeh Tacos",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"tikkaMasalaSalmon.html",
		"title":"Tikka Masala Salmon",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"tiramisu.html",
		"title":"Tiramisu",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	},
	{
		"id":"uniBaguette.html",
		"title":"Uni Baguette",
		"description":"1,2",
		"ingredients":["1", "2", "3", "4", "5", "6", "7"],
		"utensils":""
	}
];

function fnSearch(vSearchParam) {

	var vRecipesIndex = lunr(function () {
		this.ref("id")
		this.field('title')
		this.field('description')
		this.field('ingredients')
		this.field('utensils')
	  
		varrRecipes.forEach(function (doc) {
		  this.add(doc)
		}, this)
	});
	
    vResult = vRecipesIndex.search(vSearchParam);

	Handlebars.registerHelper('helperSortAlpha', function (pSortArray) {	
		return pSortArray.sort().join(', ');
	});

	var vSearchResultsTemplate = Handlebars.compile(`
		<hr>
		{{#each this}}
			<a href = "{{id}}"><h2>{{title}}</h2></a>
			<p>Ingredients: {{helperSortAlpha ingredients}}</p>
			<hr>
		{{/each}}`);


	varrResult = vResult.map(function(item) {
		return varrRecipes.find(function(vRecipe) {
			return item.ref === vRecipe.id;
		});
	});

	document.getElementById("resultList").innerHTML = vSearchResultsTemplate(varrResult);
	document.getElementById("resultsHeader").innerHTML = 'Results - "' + vSearchParam + '"';
}

function fnFindIngredients(pPageId){

	var vIngreIndex = lunr(function () {
		this.field("id")
		this.field('ingredients')
	  
		varrRecipes.forEach(function (doc) {
		  this.add(doc)
		}, this)
	});

	arrIngredientsList = vIngreIndex.search(pPageId);	

	varrResult = arrIngredientsList.map(function(item) {
		return varrRecipes.find(function(vRecipe) {
			return item.ref === vRecipe.id;
		});
	});

	return varrResult[0].ingredients;
}